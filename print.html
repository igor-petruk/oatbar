<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Oatbar</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Oatbar</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/igor-petruk/oatbar/tree/main" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="oatbar---standalone-desktop-bar"><a class="header" href="#oatbar---standalone-desktop-bar">Oatbar - standalone desktop bar</a></h1>
<p><a href="https://crates.io/crates/oatbar"><img src="https://img.shields.io/crates/v/oatbar.svg" alt="Latest Version" /></a>
<img src="https://img.shields.io/github/actions/workflow/status/igor-petruk/oatbar/on-push.yml" alt="Latest Build" />
<img src="https://img.shields.io/crates/l/oatbar" alt="Crates.io License" />
<img src="https://img.shields.io/github/languages/top/igor-petruk/oatbar" alt="GitHub top language" />
<img src="https://img.shields.io/crates/d/oatbar?label=Cargo.io%20downloads" alt="Crates.io" /></p>
<p><img src="panel-sample-left.png" alt="Panel Left" />
<img src="panel-sample-right.png" alt="Panel Right" />
<a href="main.png"><img src="main.png" alt="Screenshot" /></a></p>
<p>The motivation for creation of <code>oatbar</code> was to extend on the idea of Unix-way for toolbars.
Inspired by <code>i3bar</code> which consumes a JSON stream that controls it's appearance, we take this
idea much further without becoming a DIY widget toolkit.</p>
<p>JSON or plain text streams can be turned into text panels, progress bars or even images without
any significant coding effort.</p>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th style="text-align: center"><strong><code>oatbar</code></strong></th><th style="text-align: center">Basic bars</th><th style="text-align: center">Bars with built-in plugins</th><th style="text-align: center">DIY toolbar kits</th></tr></thead><tbody>
<tr><td><a href="configuration/cookbook/data.html">Built-in system data</a></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center">-</td></tr>
<tr><td><a href="configuration/block.html#text-block">Text widgets from custom data</a></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center"><strong>✅</strong></td></tr>
<tr><td><a href="configuration/block.html">Advanced widgets</a></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center">-</td><td style="text-align: center"><strong>✅</strong></td></tr>
<tr><td><a href="configuration/block.html">Advanced widgets with data from a custom script</a></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center">-</td><td style="text-align: center">-</td><td style="text-align: center"><strong>✅</strong></td></tr>
<tr><td><a href="configuration/block.html#image-block">Display image files from a custom script</a></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center">-</td><td style="text-align: center">-</td><td style="text-align: center"><strong>✅</strong></td></tr>
<tr><td><a href="configuration/cookbook/advanced.html#dynamic-image-block">Generate images dynamically in a custom script</a></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center">-</td><td style="text-align: center">-</td><td style="text-align: center"><strong>✅</strong></td></tr>
<tr><td><a href="cookbook/appearance.html">Control all appearance from a custom script</a></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center">-</td><td style="text-align: center">-</td><td style="text-align: center"><strong>✅</strong></td></tr>
<tr><td><a href="index.html#example">Minimal coding</a></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center">-</td></tr>
<tr><td><a href="configuration/cookbook/data.html#common-blocks">Built-in plugins have no appearance advantage over custom scripts</a></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center">-</td><td style="text-align: center">-</td><td style="text-align: center"><strong>✅</strong></td></tr>
<tr><td><a href="configuration/command">Unix-way input via pipes means customization programming language is not forced upon you</a></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center"><strong>✅</strong></td><td style="text-align: center">-</td></tr>
<tr><td><a href="configuration/cookbook/data.html#third-party-sources">Consume data from <em>other</em> ecosystems like community scripts for <code>polybar</code>, <code>i3blocks</code>, <code>i3status</code>, <code>conky</code></a></td><td style="text-align: center"><strong>✅</strong><sup class="footnote-reference" id="fr-other_eco-1"><a href="#footnote-other_eco">1</a></sup></td><td style="text-align: center">-</td><td style="text-align: center">-</td><td style="text-align: center"><strong>✅</strong></td></tr>
</tbody></table>
</div>
<h2 id="example"><a class="header" href="#example">Example</a></h2>
<pre><code class="language-toml">[[bar]]
height=32
blocks_left=["workspace"]
blocks_right=["clock"]

[[command]]
name="clock"
command="date '+%a %b %e %H:%M:%S'"
interval=1

[[command]]
name="desktop"
command="oatbar-desktop"

[[block]]
name = 'workspace'
type = 'enum'
active = '${desktop:workspace.active}'
variants = '${desktop:workspace.variants}'
on_mouse_left = "oatbar-desktop $BLOCK_INDEX"

[[block]]
name = 'clock'
type = 'text'
value = '${clock:value}'
</code></pre>
<p>Here <code>clock</code> command sends plain text, but <code>desktop</code> streams
structured data in JSON. Each is connected to text and enum selector
widgets respectively. <code>oatbar-desktop</code> ships with <code>oatbar</code>, but it is an external tool
to a bar, as can be replaced your own script.</p>
<p>Feel free to run <code>oatbar-desktop</code> and investigate it's output. <code>oatbar</code> consumes
<a href="configuration/command.html#formats">multiple text formats</a> and this data can be
displayed with minimal configuration on widgets called <a href="configuration/block.html">blocks</a>.</p>
<h2 id="ideas"><a class="header" href="#ideas">Ideas</a></h2>
<p>I truly aspire to build something unique with <code>oatbar</code>, something what other status bars lack. Do you have a cool or unconventional feature you'd like to see in <code>oatbar</code>?</p>
<p><a href="https://github.com/igor-petruk/oatbar/discussions">Join the disussion and brainstorm!</a></p>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<ul>
<li>
<p><a href="./installation.html">Installation</a></p>
</li>
<li>
<p><a href="./configuration">Configuration</a></p>
</li>
</ul>
<hr>
<ol class="footnote-definition"><li id="footnote-other_eco">
<p>In can be partial, like the lack of support for <code>polybar</code> formatting, but a lot of scripts are useful. <a href="#fr-other_eco-1">↩</a></p>
</li>
</ol><div style="break-before: page; page-break-before: always;"></div><h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<p>Please install <code>cargo</code> via the package manager or <a href="http://rustup.rs">rustup.rs</a>.</p>
<h3 id="dependencies"><a class="header" href="#dependencies">Dependencies</a></h3>
<h4 id="archlinux"><a class="header" href="#archlinux">ArchLinux</a></h4>
<pre><code class="language-sh">pacman -Sy pango cairo libxcb pkgconf
</code></pre>
<h4 id="ubuntudebian"><a class="header" href="#ubuntudebian">Ubuntu/Debian</a></h4>
<pre><code class="language-sh">apt-get install -y build-essential pkg-config \ 
  libcairo2-dev libpango1.0-dev libx11-xcb-dev
</code></pre>
<h4 id="other"><a class="header" href="#other">Other</a></h4>
<p>Install the development packages for the following libraries</p>
<ul>
<li>Cairo</li>
<li>Pango</li>
<li>x11-xcb</li>
</ul>
<h3 id="install"><a class="header" href="#install">Install</a></h3>
<pre><code class="language-sh">cargo install oatbar
</code></pre>
<p>During the first launch the bar will create a default config at
<code>~/.config/oatbar.toml</code> that should work on most machines. Run:</p>
<pre><code class="language-sh">oatbar
</code></pre>
<p>And you should see:</p>
<p><img src="new-setup.png" alt="New setup" /></p>
<h3 id="netbsd"><a class="header" href="#netbsd">NetBSD</a></h3>
<p>On NetBSD, a package is available from the official repositories.
To install it, simply run:</p>
<pre><code>pkgin install oatbar
</code></pre>
<h3 id="next"><a class="header" href="#next">Next</a></h3>
<p><a href="./configuration">Configuration</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<p>The configuration for the <code>oatbar</code> is located at <code>~/.config/oatbar.toml</code>. If you do
not have this file, it would be generated with reasonable defaults.</p>
<p><img src="configuration/../new-setup.png" alt="New setup" /></p>
<p>Proceed to <a href="configuration/./concepts.html">concepts</a> to learn basic building blocks
of <code>oatbar</code> configuration.</p>
<p>Proceed to <a href="configuration/./cookbook/">cookbook</a> if you are familiar with concepts and you are looking for a <em>recipe</em> to solve a particular problem, proceed to
the particular problem.</p>
<div class="warning">
<p>The configuration is unstable.</p>
<p>Until 1.0 release, the configuration change is unstable and
can change between minor releases. Community feedback is needed
to make sure that when configuration stabilizes, it is the best
possible.</p>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="concepts"><a class="header" href="#concepts">Concepts</a></h1>
<p><a href="configuration/./command.html"><strong>Command</strong></a> is a source of data that streams <a href="configuration/variable.html"><strong>variables</strong></a>. Variables are
used in properties of <a href="configuration/block.html"><strong>blocks</strong></a>. <a href="configuration/bar.html"><strong>Bars</strong></a> are made of blocks. All you have to learn.</p>
<pre><code class="language-toml">[[bar]]
blocks_right=["clock"]

[[block]]
name = 'clock'
type = 'text'
value = '${clock:value}'

[[command]]
name="clock"
command="date '+%a %b %e %H:%M:%S'"
</code></pre>
<p>The <code>oatctl</code> tool can be used to interact with <code>oatbar</code>. For more info:</p>
<pre><code class="language-console">oatctl help
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bar"><a class="header" href="#bar">Bar</a></h1>
<p>Bar is a single panel that is positioned at the top or the bottom of a screen.</p>
<p>Here are all the properties it can have:</p>
<pre><code class="language-toml">[[bar]]
# Blocks to show at different parts of the bar, can be empty.
# Currently it is user's responsibility is to make sure they don't overlap.
blocks_left=["block1", "block2"]
blocks_center=["block3"]
blocks_right=["block4"]

# Monitor to use as listed by `xrandr` command.
# If unspecified, the primary is used.
monitor="DP-6.8"

# Height of the bar.
height=32

# "bottom" is a default value.
position="top"

# Empty space between the blocks and the bar edges.
margin=5

# A bar is normally hidden, unless pops up.
popup=true  

# Make a popup bar pop up when the mouse is near the edge of the screen.
popup_at_edge=true  

# List of pairs [expression, regex].
# Show the block only if all expressions match respective regexes.
show_if_matches=[["${clock:value}",'.+']]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="command"><a class="header" href="#command">Command</a></h1>
<p>Command is an external program that provides data to <code>oatbar</code>.</p>
<pre><code class="language-toml"># Runs periodically
[[command]]
name="disk_free"
command="df -h / | tail -1 | awk '{print $5}'"
interval=60  # Default is 10.

# Runs once
[[command]]
name="uname"
command="uname -a"
once=true  # Default is false.

# Streams continiously
[[command]]
name="desktop"
command="oatbar-desktop"
# format="i3bar"
</code></pre>
<p><code>oatbar</code> will run each command as <code>sh -c "command"</code> to support basic shell
substitutions.</p>
<h3 id="formats"><a class="header" href="#formats">Formats</a></h3>
<p>Formats are usually auto-detected and there is no need to set <code>format</code> explicitly.</p>
<h4 id="plain"><a class="header" href="#plain"><code>plain</code></a></h4>
<p>Plain text format is just text printed to <code>stdout</code>.</p>
<pre><code class="language-toml">name="hello"
command="echo Hello world"
</code></pre>
<p>This will set <code>${hello:value}</code> <a href="configuration/./variable.html">variable</a> to be used
by <a href="configuration/./block.html">blocks</a>. If the command outputs multiple lines, each print
will set this variable to a new value. If the command runs indefinitely, the
pauses between prints can be used to only update the variable when necessary.
When the command is complete, it will be restarted after <code>interval</code>
seconds (the default is <code>10</code>).</p>
<p>If <code>line_names</code> are set, then the output is expected in groups of
multiple lines, each will set it's own variable, like <code>${hello:first_name}</code> and
<code>${hello:last_name}</code> in the following example:</p>
<pre><code class="language-toml">name="hello"
line_names=["first_name", "last_name"]
</code></pre>
<p>Many <a href="https://github.com/polybar/polybar-scripts"><code>polybar</code> scripts</a> can be
used via the <code>plain</code> format, as soon as they don't use polybar specific
formatting.</p>
<p><a href="https://vivien.github.io/i3blocks/#_format"><code>i3blocks</code> raw format</a> plugins
can be consumed too by means of the <code>line_names</code> set to standard names for
<code>i3blocks</code>.</p>
<h4 id="i3bar"><a class="header" href="#i3bar"><code>i3bar</code></a></h4>
<p><a href="https://oatbar.app/index.html"><code>i3bar</code> format</a> is the richest supported format.
It supports multiple streams of data across multiple "instances" of these streams.
In <a href="configuration/i3wm.org"><code>i3wm</code></a> this format fully controls the display of <code>i3bar</code>, where
for <code>oatbar</code> it is a yet another data source that needs to be explicitly
connected to properties of the blocks. For example instead of coloring
the block, you can choose to color the entire bar. Or you can use color <code>red</code> coming
from an <code>i3bar</code> plugin as a signal to show a hidden block.</p>
<p>Plugins that <code>oatbar</code> ships with use this format.</p>
<pre><code class="language-toml">[[command]]
name="desktop"
command="oatbar-desktop"
</code></pre>
<p>The command <code>output-desktop</code> outputs:</p>
<pre><code class="language-json">{"version":1}
[
[{"full_text":"workspace: 1","name":"workspace","active":0,"value":"1","variants":"1,2,3"},
{"full_text":"window: Alacritty","name":"window_title","value":"Alacritty"}],
...
</code></pre>
<p>This command is named <code>desktop</code> in the config.</p>
<p>Each entry is groups variables under a different <code>name</code> that
represents a purpose of the data stream, in this case: <code>workspace</code>
and <code>window_title</code>. Multiple entries with the same <code>name</code>, but different
<code>instance</code> field to represent further breakdown (e.g. names of
network interfaces from a network plugin).</p>
<p>The output from above will set
the following variables, run <code>oatbar</code> and see them in real-time</p>
<pre><code class="language-shell">$ oatctl var ls
desktop:workspace.active=0
desktop:workspace.value=1
desktop:workspace.variants=1,2,3
desktop:workspace.full_text=workspace: 1
desktop:window_title.value=Alacritty
desktop:window_title.full_text=window: Alacritty
</code></pre>
<p>If <code>instance</code> is present in the entry, then the name of the variable is
<code>command_name:name.instance.variable</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="block"><a class="header" href="#block">Block</a></h1>
<p>Blocks are the widgets displaying pieces of information on the bar.</p>
<p><code>oatbar</code> provides a lot of hidden power via these widgets, as they can provide
more than they initially seem. Consider that the most of the string properties
of blocks support variable substitution, directly controlled by your scripts.</p>
<p>The reference below explains properties of these blocks and the
<a href="configuration/./cookbook/">Cookbook</a> shows how to use them in a very clever way.</p>
<ul>
<li><a href="configuration/block.html#common-properties">Common properties</a></li>
<li><a href="configuration/block.html#text-block">Text block</a></li>
<li><a href="configuration/block.html#number-block">Number block</a>
<ul>
<li><a href="configuration/block.html#number-as-text">Number as text</a></li>
<li><a href="configuration/block.html#progress-bar">Progress bar</a></li>
</ul>
</li>
<li><a href="configuration/block.html#enum-block">Enum block</a></li>
<li><a href="configuration/block.html#image-block">Image block</a></li>
</ul>
<h2 id="common-properties"><a class="header" href="#common-properties">Common properties</a></h2>
<pre><code class="language-toml">[[block]]
# Name used as a reference 
name="block-name"

# Main input for the block.
value="&lt;b&gt;Clock:&lt;/b&gt; ${clock:value}"

# A series of regex replacements that
# are applied to `value`.
# See https://docs.rs/regex/latest/regex/
replace=[
  ["^1$","www"],
  ["^2$","term"]
]
# If true, stop applying replaces after one row matches.
# If false, keep applying replaces to the end.
replace_first_match=false

# If set, formats the final value contents after all processing and transformations
# like regex replacements or progress bar rendering.
# Not supported by image blocks.
output_format="cpu: ${value}"

# If true (default), full Pango markup is supported.
# https://docs.gtk.org/Pango/pango_markup.html
# It may be desirable to turn it off if input has
# HTML-like text to be displayed.
pango_markup=true

# List of pairs [expression, regex].
# Show the block only if all expressions match respective regexes.
show_if_matches=[["${clock:value}",'.+']]

# If set, and the bar has popup=true, then this block
# can pop up.
#   - block - the block itself pops up
#   - partial_bar - the partial bar pops up
#   - bar - the entire bar pops up.
# The surrounding separators will appear as appropriate.
popup="partial_bar"
# If unset, the popup is triggered by any property change.
# If set, the popup is triggered by change of this property.
popup_value="${clock:value}"

# Font and size of the text in the block.
font="Iosevka 14"

# Base RGBA colors of the blocks.
background="#101010bb"
foreground="#ffff00"

# Properties of lines around the block, if set.
overline_color="#..."
underline_color="#..."
edgeline_color="#..."
line_width=0.4

# Margin and padding of the block within a bar.
margin=3.0
padding=5.0

# A command to run on a particular mouse event.
# It is run with `sh -c "..."` and the process will be detached from oatbar.
# BLOCK_NAME and BLOCK_VALUE environment variables are set.
# For `enum` blocks, BLOCK_INDEX is set too.
on_mouse_left = 'chrome'
on_mouse_middle = 'chrome'
on_mouse_right = 'chrome'
on_scroll_up = 'chrome'
on_scroll_down = 'chrome'
</code></pre>
<p>To avoid repetition, consider using <code>default_block</code>, that
supports all common properties.</p>
<pre><code class="language-toml">[[default_block]]
background="#202020"
</code></pre>
<p>Multiple named <code>default_block</code> sections can be used.</p>
<pre><code class="language-toml">[[default_block]]
name="ws1_widgets"

[[block]]
inherit="ws1_widgets"
</code></pre>
<h2 id="text-block"><a class="header" href="#text-block">Text block</a></h2>
<pre><code class="language-toml">[[block]]
type="text"
</code></pre>
<p>Text blocks include all common properties, which should be enough to show
basic text or icons using <a href="https://docs.gtk.org/Pango/pango_markup.html">Pango markup</a>,
icon fonts such as <a href="https://fontawesome.com/">Font Awesome</a>,
<a href="https://www.nerdfonts.com/">Nerd Fonts</a>, <a href="https://icomoon.io/">IcoMoon</a> or emojis.</p>
<p>In addition, text blocks are used as separators to create <strong>partial bars</strong>.
They are smaller bars within a bar that groups multiple blocks together.</p>
<p><img src="configuration/img/separators.png" alt="Separators" /></p>
<pre><code class="language-toml">[[bar]]
blocks_right=["L", "music", "R", "E", "L", "layout", "S", "clock", "R"]

[[block]]
name="music"
...
show_if_matches = [['${player:now_playing.full_text}', '.+']]
popup = "partial_bar"

[[block]]
name="S"
type = "text"
separator_type = "gap"
value = "|"

[[block]]
name="E"
type = "text"
separator_type = "gap"
value = " "
background = "#00000000"

[[block]]
name="L"
type = "text"
separator_type = "left"
separator_radius = 8.0

[[block]]
name="R"
type = "text"
separator_type = "right"
separator_radius = 8.0
</code></pre>
<p><code>separator_type</code> gives a hint on where partial bars are located.
This helps when <code>popup="partial_bar"</code>. It also helps to collapse
unnecessary separators when normal blocks around them are hidden.</p>
<h2 id="number-block"><a class="header" href="#number-block">Number block</a></h2>
<pre><code class="language-toml">[[block]]
type="number"
</code></pre>
<p>Number can be displayed as text on the text block. But the real
value comes when the bar understands that the data is a number.</p>
<p>In addition to common properties, the number blocks
support unit conversions and alternative forms of display,
such as progress bars.</p>
<pre><code class="language-toml"># Min/max values are used in progress bars.
# They are set as string because they support
# variable substituion and can be specified in units.
min_value="0"
max_value="1000"

# A number type that input represents.
#  - number - a number from min to max
#  - percent - a number from 0 to 100, '%' is ommitted from the input when parsing.
#  - bytes - a number that supports byte unit suffixes, e.g. "GB", "kb",
#      - See https://docs.rs/bytesize/latest/bytesize/
number_type="percent"

# A sorted list of ramp formats. If set, prior to wrapping with `output_format`,
# wrap to the format from the entry larger than `value`.
ramp = [
  ["80%", "&lt;span foreground='yellow'&gt;${value}&lt;/span&gt;"],
  ["90%", "&lt;span foreground='red'&gt;${value}&lt;/span&gt;"],
]
</code></pre>
<p><code>number_display</code> can be used to select the widget that is going to display your
number on the block.</p>
<h3 id="number-as-text"><a class="header" href="#number-as-text">Number as text</a></h3>
<p>You can display the number as text as you would have with a <code>text</code> block, but there
is a benefit of additional functionality, such as unit conversions and ramp
functionality.</p>
<pre><code class="language-toml">[[block]]
type="number"
name="cpu"
...
number_display="progress_bar"
</code></pre>
<h3 id="progress-bar"><a class="header" href="#progress-bar">Progress bar</a></h3>
<pre><code class="language-toml">[[block]]
type="number"
name="cpu"
...
number_display="progress_bar"
# How many characters to use for the progress bar.
progress_bar_size=10
# Progress bar characters. In this example would render: "━━━━雷     "
empty=" "
fill="━"
indicator="雷"
# Each of the above can be a ramp
# fill = [
#  ["", "━"],
#  ["60%", "&lt;span foreground='yellow'&gt;━&lt;/span&gt;"],
#  ["90%", "&lt;span foreground='red'&gt;━&lt;/span&gt;"],
# ]
</code></pre>
<h2 id="enum-block"><a class="header" href="#enum-block">Enum block</a></h2>
<pre><code class="language-toml">[[block]]
type="enum"
</code></pre>
<p>Enum is different from text block as it renders multiple child text blocks called
<code>variants</code>, only one of which is <code>active</code>. <em>Example:</em> keyboard layout switch.</p>
<p>Almost every common property related to block display has an <code>active_</code> counterpart
to configure an active block. For example <code>background</code> and <code>active_background</code>.</p>
<pre><code class="language-toml"># A separated list of variants, e.g. "ua,se,us".
variants = '${keyboard:layout.variants}'
# An index of the item that is to be active starting from 0.
active = '${keyboard:layout.active}'
# A separator for the variants list. Default: ",".
enum_separator="|"
</code></pre>
<p>Text processing via <code>replace</code> is done per item of the <code>variants</code> separately,
not together. If an variant becomes empty as a result of processing, it will
not be displayed, but it won't impact the meaning of <code>active</code> index.</p>
<p><code>BLOCK_INDEX</code> environment variable set for <code>on_mouse_left</code> command is set to
the index of the variant that was clicked on.</p>
<h2 id="image-block"><a class="header" href="#image-block">Image block</a></h2>
<pre><code class="language-toml">[[block]]
type="image"
</code></pre>
<p>In image blocks, the <code>value</code> property is interpreted as and image file name to be
rendered. Supported formats: BMP, ICO, JPEG, PNG, SVG, WEBP.</p>
<pre><code># If set, can shrink the image smaller than automatically determined size.
max_image_height=20
# If this value is set and changed, then image caching gets disabled and
# image is reloaded from the filesystem even if the filename stayed the same.
# It can be used by a command to generate dynamic images under the same filename.
updater_value="${image_generator:timestamp}"
</code></pre>
<p>The block offers rich possibilities, provided you can generate your own
images or download them from the Internet on flight in the command that generates
a filename.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="varable"><a class="header" href="#varable">Varable</a></h1>
<ul>
<li><a href="configuration/variable.html#standalone-variables">Standalone variables</a>
<ul>
<li><a href="configuration/variable.html#filters">Filters</a></li>
</ul>
</li>
</ul>
<p>Variables are at length described in the <a href="configuration/./command.html">Command</a> section
where they are produced and in the <a href="configuration/./block.html">Block</a> section where they
are consumed.</p>
<p>If <code>oatbar</code> is running and you have added a few commands, you can see all available variables
using <code>oatctl</code> command:</p>
<pre><code>$ oatctl var ls
clock:value=Mon Jul  8 00:40:19
desktop:window_title.full_text=window: Alacritty
desktop:window_title.value=Alacritty
desktop:workspace.active=0
desktop:workspace.full_text=workspace: 1
desktop:workspace.value=1
desktop:workspace.variants=1,2
...
</code></pre>
<p>More info on how to get and set variables programmatically:</p>
<pre><code>$ oatctl var help
</code></pre>
<h1 id="standalone-variables"><a class="header" href="#standalone-variables">Standalone variables</a></h1>
<p>You can declare your additional variables that do not come from commands. This is useful to
pre-process data with <a href="configuration/./block.html#common-properties"><code>replace</code> and <code>replace_first_match</code></a> to be used in multiple blocks.</p>
<pre><code class="language-toml">[[var]]
name="clock_color_attr"
value = '${clock:color}'
replace = [["(.+)","foreground='$1'"]]

[[block]]
value = "&lt;span ${clock_color_attr}&gt;${clock:value}&lt;/span&gt;"
</code></pre>
<p>Standalone variables can use each other only in the order they are declared in the file,
otherwise the result is undefined.</p>
<h2 id="filters"><a class="header" href="#filters">Filters</a></h2>
<p>Filters are additional functions you can apply to values inside of the <code>${...}</code> expressions. Example:</p>
<pre><code class="language-toml">value = '${desktop:window_title.value|def:(no selected window)|max:100}'
</code></pre>
<p>Supported filters:</p>
<ul>
<li><code>def</code> sets the default value if the input variable is empty</li>
<li><code>max</code> limits the length of the input. If it is larger, it is shortened with ellipsis (<code>...</code>)</li>
<li><code>align</code> aligns the text to occupy fixed width if it is shorter than a certain length
<ul>
<li>First character is the filler</li>
<li>Second character is an alignment: <code>&lt;</code>, <code>^</code> (center) or <code>&gt;</code></li>
<li>Min width</li>
<li>Example:
<ul>
<li><code>hello</code> passed via <code>align:_&gt;10</code> will be <code>_____hello</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cookbook"><a class="header" href="#cookbook">Cookbook</a></h1>
<p><code>oatbar</code> tries to keep pre-packaged plugins or modules to a minimum.
Instead it offers easy ways of achieving the same by integrating
external data sources, tools or modules from ecosystems of other bars.</p>
<h2 id="next-1"><a class="header" href="#next-1">Next</a></h2>
<ol>
<li>Learn where to get <a href="configuration/cookbook/./data.html"><strong>data</strong></a> to show it on the bar.</li>
<li>If you have the data, proceed learning how to <a href="configuration/cookbook/./appearance.html"><strong>display</strong></a> it.</li>
<li>If you know the basic, see some <a href="configuration/cookbook/./advanced.html"><strong>advanced applications</strong></a> of <code>oatbar</code> concepts.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="data"><a class="header" href="#data">Data</a></h1>
<p>This chapter contains examples of common sources and methods of ingesting
data for your blocks.</p>
<ul>
<li><a href="configuration/cookbook/data.html#common-blocks">Common Blocks</a>
<ul>
<li><a href="configuration/cookbook/data.html#app-launcher">App Launcher</a></li>
<li><a href="configuration/cookbook/data.html#clock">Clock</a></li>
<li><a href="configuration/cookbook/data.html#keyboard">Keyboard</a>
<ul>
<li><a href="configuration/cookbook/data.html#layout">Layout</a></li>
<li><a href="configuration/cookbook/data.html#indicators">Indicators</a></li>
</ul>
</li>
<li><a href="configuration/cookbook/data.html#active-workspaces-and-windows">Active workspaces and windows</a></li>
<li><a href="configuration/cookbook/data.html#system-stats">System stats</a></li>
<li><a href="configuration/cookbook/data.html#disk-space">Disk space</a></li>
</ul>
</li>
<li><a href="configuration/cookbook/data.html#third-party-sources">Third-party sources</a>
<ul>
<li><a href="configuration/cookbook/data.html#i3status"><code>i3status</code></a></li>
<li><a href="configuration/cookbook/data.html#conky"><code>conky</code></a></li>
<li><a href="configuration/cookbook/data.html#i3blocks"><code>i3blocks</code></a></li>
<li><a href="configuration/cookbook/data.html#http-apis">HTTP APIs</a></li>
<li><a href="configuration/cookbook/data.html#file">File</a></li>
<li><a href="configuration/cookbook/data.html#socket">Socket</a></li>
</ul>
</li>
</ul>
<h2 id="common-blocks"><a class="header" href="#common-blocks">Common Blocks</a></h2>
<h3 id="app-launcher"><a class="header" href="#app-launcher">App Launcher</a></h3>
<pre><code class="language-toml">[[block]]
name='browser'
type = 'text'
value = "&lt;span font='Font Awesome 6 Free 22'&gt;&lt;/span&gt; "
on_mouse_left = 'chrome'
</code></pre>
<h3 id="clock"><a class="header" href="#clock">Clock</a></h3>
<pre><code class="language-toml">[[command]]
name="clock"
command="date '+%a %b %e %H:%M:%S'"
interval=1

[[block]]
name = 'clock'
type = 'text'
value = '${clock:value}'
</code></pre>
<p>If you do not need to show seconds, you can make <code>interval</code> smaller.</p>
<h3 id="keyboard"><a class="header" href="#keyboard">Keyboard</a></h3>
<p><code>oatbar</code> ships with keyboard status utility that streams keyboard layouts
and indicator values in <code>i3bar</code> format.</p>
<p>If you run it, you will see</p>
<pre><code class="language-json">❯ oatbar-keyboard
{"version":1}
[
[{"full_text":"layout: us","name":"layout","active":0,"value":"us","variants":"us,ua"},
{"full_text":"caps_lock:off","name":"indicator","instance":"caps_lock","value":"off"},
 ...],
</code></pre>
<p>Enable it with</p>
<pre><code class="language-toml">[[command]]
name="keyboard"
command="oatbar-keyboard"
</code></pre>
<h4 id="layout"><a class="header" href="#layout">Layout</a></h4>
<p><code>oatbar-keyboard</code> is designed to work with <code>setxkbmap</code>.
For example you set up your layouts on each WM start like this:</p>
<pre><code class="language-shell">setxkbmap -layout us,ua -option grp:alt_space_toggle
</code></pre>
<p>Enable <code>oatbar-keyboard</code> and use an <code>enum</code> block:</p>
<pre><code class="language-toml">[[block]]
name = 'layout'
type = 'enum'
active = '${keyboard:layout.active}'
variants = '${keyboard:layout.variants}'
on_mouse_left = "oatbar-keyboard layout set $BLOCK_INDEX"
</code></pre>
<h4 id="indicators"><a class="header" href="#indicators">Indicators</a></h4>
<p>Show indicators, such as <code>caps_lock</code>, <code>scroll_lock</code> and <code>num_lock</code>
as follows:</p>
<pre><code class="language-toml">[[block]]
name = 'caps_lock'
type = 'text'
value = '${keyboard:indicator.caps_lock.full_text}'
</code></pre>
<h3 id="active-workspaces-and-windows"><a class="header" href="#active-workspaces-and-windows">Active workspaces and windows</a></h3>
<p><code>oatbar-desktop</code> talks to your WM via EWMH protocol to obtain
the information about active workspaces and windows.</p>
<pre><code class="language-json">❯ oatbar-desktop
{"version":1}
[
[{"full_text":"workspace: 1","name":"workspace","active":0,"value":"1","variants":"1,2,3"},
{"full_text":"window: Alacritty","name":"window_title","value":"Alacritty"}],
</code></pre>
<pre><code class="language-toml">[[command]]
name="desktop"
command="oatbar-desktop"

[[block]]
name = 'workspace'
type = 'enum'
active = '${desktop:workspace.active}'
variants = '${desktop:workspace.variants}'
# Optional replacement with icons
replace = [
   ["1",""],
   ["2",""],
   ["3",""]
]
font="Font Awesome 6 Free 13"
on_mouse_left = "oatbar-desktop $BLOCK_INDEX"

[[block]]
name='window'
type = 'text'
value = '${desktop:window_title.value|max:100}'
pango_markup = false  # Window title can happen to have HTML.
</code></pre>
<h3 id="system-stats"><a class="header" href="#system-stats">System stats</a></h3>
<p><code>oatbar</code> ships with a <code>oatbar-stats</code> utility that streams system stats in the <code>i3bar</code>
format:</p>
<ul>
<li>CPU</li>
<li>Memory</li>
<li>Network
<ul>
<li>Interface names</li>
<li>Running status</li>
<li>Address</li>
<li>Download and upload rates</li>
</ul>
</li>
</ul>
<p>There is a lot of data you can display on your <code>blocks</code>. Enable <code>oatbar-stats</code>
like this:</p>
<pre><code class="language-toml">[[command]]
name="stats"
command="oatbar-stats"
</code></pre>
<p>Restart <code>oatbar</code> and examine the new variables.</p>
<pre><code class="language-shell">oatctl var ls | grep '^stats:'
</code></pre>
<p>The example output below.</p>
<pre><code class="language-ini">stats:cpu.full_text=cpu:  2%
stats:cpu.percent=2
stats:memory.free=8744980480
stats:memory.full_text=mem: 73% 32.9 GB
stats:memory.percent=73
stats:memory.total=32915705856
stats:memory.used=24170725376
stats:net.igc0.full_text=igc0: 192.168.0.160
stats:net.igc0.ipv4_0_addr=192.168.0.160
stats:net.igc0.ipv4_0_broadcast=192.168.0.255
stats:net.igc0.ipv4_0_run=true
stats:net.igc0.ipv4_0_up=true
stats:net.igc0.mac_0_addr=48:21:0b:35:ca:08
stats:net.igc0.mac_0_run=true
stats:net.igc0.mac_0_up=true
stats:net.igc0.rx_per_sec=1704
stats:net.igc0.tx_per_sec=1110
...
</code></pre>
<p>Entries with <code>full_text</code> are a good start to display directly,
if you do not need more fine grained customizations.</p>
<pre><code class="language-toml">[[block]]
name="ethernet"
type="text"
value="${stats:net.igc0.full_text}"
</code></pre>
<h3 id="disk-space"><a class="header" href="#disk-space">Disk space</a></h3>
<p>Example for <code>/home</code> directory partition:</p>
<pre><code class="language-toml">[[command]]
name="home_free"
command="df -h /home | tail -1 | awk '{print $5}'"
interval=60

[[block]]
name='home_free'
type = 'text'
value = '&lt;b&gt;/home&lt;/b&gt; ${home_free:value}'
</code></pre>
<h2 id="third-party-sources"><a class="header" href="#third-party-sources">Third-party sources</a></h2>
<p>Existing bar ecosystems already can provide large mount of useful information.
<code>oatbar</code> by-design focuses on making it possible to adapt third-party data sources.</p>
<h3 id="i3status"><a class="header" href="#i3status"><code>i3status</code></a></h3>
<p><code>i3status</code> is a great cross-platform source of information about the system. It supports:</p>
<ul>
<li>CPU</li>
<li>Memory</li>
<li>Network</li>
<li>Battery</li>
<li>Volume</li>
</ul>
<p><code>i3status</code> is designed to be used by <code>i3bar</code>, but <code>oatbar</code> supports this format natively.
Enable it in <code>~/.i3status.conf</code> or in <code>~/.config/i3status/config</code>:</p>
<pre><code class="language-conf">general {
        output_format = "i3bar"
}
</code></pre>
<p>Add you plugin as described in the <a href="https://i3wm.org/docs/i3status.html"><code>i3status</code> documentation</a>.
Prefer simple output format, as you can format it on the <code>oatbar</code> side. Example:</p>
<pre><code>order += cpu_usage

cpu_usage {
   format = "%usage"
}
</code></pre>
<p>If you run <code>i3status</code> you will now see</p>
<pre><code class="language-json">❯ i3status
{"version":1}
[
[{"name":"cpu_usage","markup":"none","full_text":"00%"}]
,[{"name":"cpu_usage","markup":"none","full_text":"02%"}]
</code></pre>
<p>In <code>oatbar</code> config:</p>
<pre><code class="language-toml">[[block]]
name='cpu'
type = 'number'
value = "${i3status:cpu_usage.full_text}"
number_type = "percent"
output_format="&lt;b&gt;CPU:&lt;/b&gt;${value}"
number_display="text"
</code></pre>
<p>If you prefer a progress bar:</p>
<pre><code class="language-toml">number_display="progress_bar"
</code></pre>
<h3 id="conky"><a class="header" href="#conky"><code>conky</code></a></h3>
<p>As <code>i3status</code>, <code>conky</code> can also be a great source of system data.</p>
<p><code>conky</code> can print it's <a href="https://conky.sourceforge.net/variables.html">variables</a> as plain text
and <code>oatbar</code> can consume it as multi-line plain text. Example <code>~/.oatconkyrc</code>:</p>
<pre><code class="language-lua">conky.config = {
    out_to_console = true,
    out_to_x = false,
    update_interval = 1.0,
}

conky.text = [[
$memperc%
$cpu%
]]
</code></pre>
<p>If you run <code>conky -c ~/.oatconkyrc</code> you will see repeating groups of numbers:</p>
<pre><code>2%
10%
5%
10%
</code></pre>
<p>In <code>oatbar</code> config:</p>
<pre><code class="language-toml">[[command]]
name="conky"
command="conky -c ~/.oatconkyrc"
line_names=["mem","cpu"]

[[block]]
name='cpu'
type = 'number'
value = "${conky:cpu}"
number_type = "percent"

[block.number_display]
type="text"
output_format="&lt;b&gt;CPU:&lt;/b&gt;${value}"

[[block]]
name='mem'
type = 'number'
value = "${conky:mem}"
number_type = "percent"

[block.number_display]
type="text"
output_format="&lt;b&gt;MEM:&lt;/b&gt;${value}"
</code></pre>
<h3 id="i3blocks"><a class="header" href="#i3blocks"><code>i3blocks</code></a></h3>
<p><code>i3blocks</code> in a drop-in replacement for <code>i3status</code> to be used in
<code>i3bar</code>. If you have existingi <code>i3blocks</code> configs, feel free to plug it
directly into <code>oatbar</code>:</p>
<pre><code class="language-toml">[[command]]
name="i3blocks"
command="i3blocks"
</code></pre>
<p>You can check which <code>oatbar</code> variables it makes available by running
<code>i3blocks</code> in your console.</p>
<p>The indirection between the script, <code>i3blocks</code> and <code>oatbar</code> is not required.
You can connect any plugin from the <a href="https://github.com/vivien/i3blocks-contrib"><code>i3block-contrib</code></a>
excellent collection directly into <code>oatbar</code>.</p>
<p>For example:</p>
<pre><code class="language-console">$ git clone https://github.com/vivien/i3blocks-contrib
$ cd ./i3blocks-contrib/cpu_usage2
$ make
$ ./cpu_usage2 -l "cpu: "
cpu: &lt;span&gt; 39.79%&lt;/span&gt;
cpu: &lt;span&gt; 47.06%&lt;/span&gt;
</code></pre>
<p>As you can see, it inputs only one line of data each interval,
so setting <code>line_names</code> is not necessary, however always check for it.</p>
<pre><code class="language-toml">[[command]]
name="cpu_usage2"
command="/path/to/cpu_usage2 -l 'cpu: '"

[[block]]
name="cpu_usage2"
type="text"
value="${cpu_usage2:value}"
</code></pre>
<h3 id="http-apis"><a class="header" href="#http-apis">HTTP APIs</a></h3>
<p>HTTP JSON APIs that do not require complicated login are extremely
easy to integrate using <code>curl</code> and <code>jq</code>.</p>
<p>Explore your JSON first</p>
<pre><code class="language-console">$ curl 'https://api.ipify.org?format=json'
{"ip":"1.2.3.4"}
</code></pre>
<p><code>jq -r</code> let's you extract a value from a JSON object. Add the command
to <code>oatbar</code> config, but make sure to set a sufficient <code>interval</code> not to get
banned.</p>
<pre><code class="language-toml">[[command]]
name="ip"
command="curl 'https://api.ipify.org?format=json | jq -r .ip"
interval=1800

[[block]]
name="ip"
type="text"
value="my ip: ${ip:value}"
</code></pre>
<h3 id="file"><a class="header" href="#file">File</a></h3>
<p>You can use file watching utils to output file contents on any file change.
For example for Linux you can use <code>fswatch</code>.</p>
<pre><code class="language-toml">[[command]]
command="cat ./file; fswatch --event Updated ./file | xargs -I {} cat {}"
</code></pre>
<h3 id="socket"><a class="header" href="#socket">Socket</a></h3>
<p>Use <code>socat</code> to read from sockets. TCP socket:</p>
<pre><code class="language-toml">[[command]]
command="socat TCP:localhost:7777 -"
</code></pre>
<p>SSL socket:</p>
<pre><code class="language-toml">[[command]]
command="socat OPENSSL:localhost:7777 -"
</code></pre>
<p>For Unix socket:</p>
<pre><code class="language-toml">[[command]]
command="socat UNIX-CONNECT:/path/to/socket -"
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="appearance"><a class="header" href="#appearance">Appearance</a></h1>
<p>This section focuses on recipes on how to display the data from your sources.</p>
<ul>
<li><a href="configuration/cookbook/appearance.html#separators">Separators</a>
<ul>
<li><a href="configuration/cookbook/appearance.html#simple-separator">Simple separator</a></li>
<li><a href="configuration/cookbook/appearance.html#empty-space-around-bar">Empty space around bar</a></li>
<li><a href="configuration/cookbook/appearance.html#border-lines">Border lines</a></li>
<li><a href="configuration/cookbook/appearance.html#partial-bar">Partial bar</a></li>
</ul>
</li>
<li><a href="configuration/cookbook/appearance.html#blocks">Blocks</a>
<ul>
<li><a href="configuration/cookbook/appearance.html#pango-markup">Pango markup</a></li>
<li><a href="configuration/cookbook/appearance.html#icons">Icons</a></li>
<li><a href="configuration/cookbook/appearance.html#visibility">Visibility</a></li>
</ul>
</li>
<li><a href="configuration/cookbook/appearance.html#popup-bars">Popup bars</a>
<ul>
<li><a href="configuration/cookbook/appearance.html#popup-at-cursor">Popup at cursor</a></li>
<li><a href="configuration/cookbook/appearance.html#temporary-popup-on-block-change">Temporary popup on block change</a></li>
</ul>
</li>
</ul>
<h2 id="separators"><a class="header" href="#separators">Separators</a></h2>
<h3 id="simple-separator"><a class="header" href="#simple-separator">Simple separator</a></h3>
<p><img src="configuration/cookbook/separator.png" alt="Separator" /></p>
<p>Separator is just a text block.</p>
<pre><code class="language-toml">[[bar]]
blocks_left=["foo", "S", "bar", "S", "baz"]

[[block]]
name="S"
type = 'text'
separator_type = 'gap'
value = '|'
foreground = "#53e2ae"
</code></pre>
<p>This approach offers maximum flexibility:</p>
<ul>
<li>Multiple separator types and styles</li>
<li>Dynamically separators based on conditions</li>
<li>Disappearing separators via <code>show_if_matches</code></li>
</ul>
<p>Specifying <code>separator_type = "gap"</code> is recommended. It gives <code>oatbar</code> a hint that the block is
a separator. For example multiple separators in a row do not make sense and
they will collapse if real blocks between them become hidden.</p>
<h3 id="empty-space-around-bar"><a class="header" href="#empty-space-around-bar">Empty space around bar</a></h3>
<p>By default <code>oatbar</code> looks more traditional.</p>
<p><img src="configuration/cookbook/no-space.png" alt="No Space" /></p>
<p>You can apply margins and border-lines to achieve some empty space around your bar.</p>
<p><img src="configuration/cookbook/empty-space.png" alt="Empty Space" /></p>
<pre><code class="language-toml">[[bar]]
blocks_right=["L", "layout", "S", "clock", "R"]
# `top` may need a value or must be zero depening on your WM.
margin={left=8, right=8, top=0, bottom=8}
# Alpha channels is zero, so the bar is transparent unless there is has a block.
background="#00000000"

[[default_block]]
# The actual block color.
background="#191919e6"

[[block]]
name='L'
type = 'text'
separator_type = 'left'
separator_radius = 8.0

[[block]]
name='R'
type = 'text'
separator_type = 'right'
separator_radius = 8.0
</code></pre>
<h3 id="border-lines"><a class="header" href="#border-lines">Border lines</a></h3>
<p><img src="configuration/cookbook/border-lines.png" alt="Border Lines" /></p>
<pre><code class="language-toml"># Or per [[block]] separately.
[[default_block]]
edgeline_color = "#53e2ae"
overline_color = "#53e2ae"
underline_color = "#53e2ae"

# edgeline applies to `left` and `right` blocks.
[[block]]
name='L'
type = 'text'
separator_type = 'left'
separator_radius = 8.0

[[block]]
name='R'
type = 'text'
separator_type = 'right'
separator_radius = 8.0
</code></pre>
<h3 id="partial-bar"><a class="header" href="#partial-bar">Partial bar</a></h3>
<p>Bars of <code>oatbar</code> can be further separated to small partial bars. It is possible
to by further use of <code>L</code> and <code>R</code> bars and addition of completely transparent <code>E</code> block.</p>
<p><img src="configuration/cookbook/partial-bar.png" alt="Partial Bar" /></p>
<pre><code class="language-toml">[[bar]]
blocks_left=["L", "workspace", "R", "E", "L", "active_window", "R"]

[[block]]
name="E"
type = 'text'
separator_type = 'gap'
value = ' '
background = "#00000000"
# If you have set these in [[default_block]], reset them back.
edgeline_color = ""
overline_color = ""
underline_color = ""
</code></pre>
<p>Setting <code>separator_type</code> correctly for all separators will make partial panel
disappearing if all real blocks are hidden via <code>show_if_matches</code>.</p>
<h2 id="blocks"><a class="header" href="#blocks">Blocks</a></h2>
<h3 id="pango-markup"><a class="header" href="#pango-markup">Pango markup</a></h3>
<p><code>oatbar</code> supports full <a href="https://docs.gtk.org/Pango/pango_markup.html">Pango Markup</a>
as a main tool to format the block content. Command can emit Pango markup too, controlling
the appearance of the blocks.</p>
<p><img src="configuration/cookbook/pango.png" alt="Pango" /></p>
<pre><code class="language-toml">[[block]]
name='pango'
type = 'text'
value = "&lt;span text_transform='capitalize' color='yellow'&gt;h&lt;i&gt;ell&lt;/i&gt;o&lt;/span&gt; &lt;span color='lawngreen'&gt;World&lt;/span&gt;"
</code></pre>
<p>Font names to be used in Pango can be looked up via the <code>fc-list</code> command.</p>
<h3 id="icons"><a class="header" href="#icons">Icons</a></h3>
<p>Use icon fonts such as <a href="https://fontawesome.com/">Font Awesome</a>,
<a href="https://www.nerdfonts.com/">Nerd Fonts</a>, <a href="https://icomoon.io/">IcoMoon</a> or emojis.</p>
<p><img src="configuration/cookbook/icon.png" alt="Icon" /></p>
<pre><code class="language-toml">[[block]]
name='pango'
type = 'text'
value = "&lt;span ${green_icon}&gt;&lt;/span&gt;  Symbolico - I'm free"

[[var]]
name="green_icon"
value="font='Font Awesome 6 Free 13' foreground='#53e2ae'"
</code></pre>
<p>Some icon fonts use ligatures instead of emojis, replacing words with icons like this:</p>
<pre><code class="language-toml">value = "&lt;span ${green_icon}&gt;music&lt;/span&gt;  Symbolico - I'm free"
</code></pre>
<p>If your icon does not perfectly vertically align with your text, experiment with font size and <code>rise</code> Pango parameter.</p>
<h3 id="visibility"><a class="header" href="#visibility">Visibility</a></h3>
<p><code>show_if_matches</code> combined with a powerful tool to build dynamic bars.
Here it is used to only show the block if the value is not empty.</p>
<pre><code class="language-toml">[block]
value = '${desktop:window_title.value}'
show_if_matches = [['${desktop:window_title.value}', '.+']]
</code></pre>
<p>Custom variables, not only those coming from commands can be used. They can be
set via <code>oatctl var set</code>, opening a huge number of possibilities. See some examples in
the <a href="configuration/cookbook/./advanced.html">Advanced</a> chapter.</p>
<p>If you are not an expert in regular expressions, here are some useful ones:</p>
<div class="table-wrapper"><table><thead><tr><th>Regex</th><th>Meaning</th></tr></thead><tbody>
<tr><td><code>foo</code></td><td>Contains <code>foo</code></td></tr>
<tr><td><code>^foo</code></td><td>Starts with <code>foo</code></td></tr>
<tr><td><code>foo$</code></td><td>Ends with <code>foo</code></td></tr>
<tr><td><code>^foo$</code></td><td>Exactly <code>foo</code></td></tr>
<tr><td><code>^$</code></td><td>Empty string</td></tr>
<tr><td><code>.+</code></td><td>Non empty string</td></tr>
<tr><td><code>(foo|bar|baz)</code></td><td>Contains one of those words</td></tr>
<tr><td><code>^(foo|bar|baz)$</code></td><td>Exactly one of those words</td></tr>
</tbody></table>
</div>
<p>In the examples above <code>foo</code> works because it only contains alpha-numeric characters,
but be careful with including characters that have special meaning in regular expressions.
For more info read <code>regex</code> crate <a href="https://docs.rs/regex/latest/regex/#syntax">documentation</a>.</p>
<h2 id="popup-bars"><a class="header" href="#popup-bars">Popup bars</a></h2>
<p>A bar can be hidden and appear when certain conditions are met.</p>
<pre><code class="language-toml">[[bar]]
popup=true
</code></pre>
<p>Popup bars appear on the top of the windows, unlike normal bars that
allocate dedicated space on the screen.</p>
<p><img src="configuration/cookbook/popup-edge.png" alt="Popup Edge" /></p>
<h3 id="popup-at-cursor"><a class="header" href="#popup-at-cursor">Popup at cursor</a></h3>
<p>Popup bar can be shown when the cursor approaches the screen edge where the bar is located.</p>
<pre><code class="language-toml">[[bar]]
popup=true
popup_at_edge=true  
</code></pre>
<h3 id="temporary-popup-on-block-change"><a class="header" href="#temporary-popup-on-block-change">Temporary popup on block change</a></h3>
<p>When <em>any property</em> of the block changes you can make it appear. Depending on a <code>popup</code>
value you can show enclosing partial or entire bar.</p>
<pre><code class="language-toml">[[bar]]
popup="bar"
#popup="partial_bar"
#popup="block"
</code></pre>
<p>If you won't want to popup on any property change, you can limit it to one expression.</p>
<pre><code class="language-toml">[[bar]]
popup_value="${foo}"
</code></pre>
<p>Example layout switcher that appears in the middle of the screen when you change your layout.</p>
<pre><code class="language-toml">[[bar]]
blocks_center=["L", "layout_enum_center", "R"]
background="#00000000"
popup=true
position="center"

[[block]]
name = 'layout_enum_center'
type = 'enum'
active = '${keyboard:layout.active}'
variants = '${keyboard:layout.variants}'
popup = "block"
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="advanced-examples"><a class="header" href="#advanced-examples">Advanced examples</a></h1>
<p>Let's build something complex with what <code>oatbar</code> has to offer.</p>
<ul>
<li><a href="configuration/cookbook/advanced.html#workspace-customizations">Workspace customizations</a>
<ul>
<li><a href="configuration/cookbook/advanced.html#appearance">Appearance</a></li>
<li><a href="configuration/cookbook/advanced.html#visibility">Visibility</a></li>
</ul>
</li>
<li><a href="configuration/cookbook/advanced.html#menu">Menu</a></li>
<li><a href="configuration/cookbook/advanced.html#rotating-menu">Rotating menu</a></li>
<li><a href="configuration/cookbook/advanced.html#dynamic-image-block">Dynamic image block</a></li>
</ul>
<p>Combination of variables, visibility control and programmatic access to variables via <code>oatctl var</code> provides
tremendous power.</p>
<p>In these examples <code>oatctl var</code> is often called from <code>on_mouse_left</code> handlers, but you
can use it in your WM keybindings too.</p>
<h2 id="workspace-customizations"><a class="header" href="#workspace-customizations">Workspace customizations</a></h2>
<p>If you have enabled <code>oatbar-desktop</code> command, you should have access to the <code>${desktop:workspace.value}</code>
variable.</p>
<pre><code class="language-toml">[[command]]
name="desktop"
command="oatbar-desktop"
</code></pre>
<p>See which values it can have via <code>oatctl var ls | grep desktop</code> when running <code>oatbar</code>. You can use
this to set any properties of your block, including appearance and visibility.</p>
<h3 id="appearance-1"><a class="header" href="#appearance-1">Appearance</a></h3>
<p>In this example, the bar on workspace <code>two</code> is a bit more red than usual.</p>
<pre><code class="language-toml">[[var]]
name="default_block_bg"
value="${desktop:workspace.value}"
replace_first_match=true
replace=[
  ["^two$","#301919e6"],
  [".*", "#191919e6"],
]

[[default_block]]
background="${default_block_bg}"
</code></pre>
<h3 id="visibility-1"><a class="header" href="#visibility-1">Visibility</a></h3>
<p>This block shown only on workspace <code>three</code>.</p>
<pre><code class="language-toml">[[block]]
show_if_matches=[["${desktop:workspace.value}", "^three$"]]
</code></pre>
<h2 id="menu"><a class="header" href="#menu">Menu</a></h2>
<p><code>oatbar</code> does not know anything about menus, but let's build one.</p>
<p><img src="configuration/cookbook/menu-closed.png" alt="Menu Closed" /></p>
<p><img src="configuration/cookbook/menu-open.png" alt="Menu Open" /></p>
<pre><code class="language-toml">[[bar]]
blocks_left=["L", "menu", "launch_chrome", "launch_terminal", "R"]

[[default_block]]
background="#191919e6"

[[default_block]]
name="menu_child"
background="#111111e6"
line_width=3
overline_color="#191919e6"
underline_color="#191919e6"
show_if_matches=[["${show_menu}","show"]]

[[block]]
name='menu'
type = 'text'
value = "${show_menu}"
replace = [
   ["^$", "circle-right"],
   ["show", "circle-left"],
   ["(.+)","&lt;span font='IcoMoon-Free 12' weight='bold' color='#53e2ae'&gt;$1&lt;/span&gt;"],
]
on_mouse_left = "oatctl var rotate show_menu right '' show"

[[block]]
name='launch_chrome'
type = 'text'
inherit="menu_child"
value = "&lt;span font='IcoMoon-Free 12'&gt;&lt;/span&gt; "
on_mouse_left = "oatctl var set show_menu ''; chrome"

[[block]]
name='launch_terminal'
type = 'text'
inherit="menu_child"
value = "&lt;span font='IcoMoon-Free 12'&gt;&lt;/span&gt; "
on_mouse_left = "oatctl var set show_menu ''; alacritty"
</code></pre>
<p>Let's take a closer look:</p>
<ol>
<li>We create a <code>show_menu</code> variable that can be empty or set to <code>show</code></li>
<li>In <code>menu</code> block all regexes apply in sequence.</li>
<li>The first two replace it with icon names.</li>
<li>The last one wraps the icon name into the final Pango markup.</li>
<li>The <code>on_mouse_left</code> rotates the values of <code>show_menu</code> between empty and <code>show</code>, effectively toggling it.</li>
<li>Blocks are only displayed if <code>show_menu</code> is set.</li>
<li>Blocks clear <code>show_menu</code> before launching the app to hide the menu.</li>
<li>A small cosmetic effect is achieved by inheriting a <code>default_block</code> with a different style.</li>
</ol>
<p>This example can be extended to build more layers of nesting by introducing additional variables.</p>
<h2 id="rotating-menu"><a class="header" href="#rotating-menu">Rotating menu</a></h2>
<p>It sometimes useful to always show the main panel, but have an occasional access to additional
information. A great idea would be to build a rotating menu.</p>
<p><img src="configuration/cookbook/panel_0.png" alt="Panel 0" />  
<img src="configuration/cookbook/panel_1.png" alt="Panel 1" />  
<img src="configuration/cookbook/panel_2.png" alt="Panel 2" /></p>
<pre><code class="language-toml">[[bar]]
blocks_left=["L", "rotate_left", "panel_0", "panel_1", "panel_2", "rotate_right", "R"]

[[block]]
name='rotate_left'
type = 'text'
value = "&lt;span font='IcoMoon-Free 12' color='#53e2ae'&gt;circle-left&lt;/span&gt;"
on_mouse_left = "oatctl var rotate rotation_idx left '' 1 2"

[[block]]
name='rotate_right'
type = 'text'
value = "&lt;span font='IcoMoon-Free 12' color='#53e2ae'&gt;circle-right&lt;/span&gt;"
on_mouse_left = "oatctl var rotate rotation_idx right '' 1 2"

[[block]]
name='panel_0'
type = 'text'
value = "&lt;span color='yellow'&gt;Panel 0&lt;/span&gt;"
show_if_matches=[["${rotation_idx}", "^$"]]

[[block]]
name='panel_1'
type = 'text'
value = "&lt;span color='lime'&gt;Panel 1&lt;/span&gt;"
show_if_matches=[["${rotation_idx}", "1"]]

[[block]]
name='panel_2'
type = 'text'
value = "&lt;span color='deeppink'&gt;Panel 2&lt;/span&gt;"
show_if_matches=[["${rotation_idx}", "2"]]
</code></pre>
<h2 id="dynamic-image-block"><a class="header" href="#dynamic-image-block">Dynamic image block</a></h2>
<p><img src="configuration/cookbook/custom-clock.png" alt="Custom clock" /></p>
<p>This looks like a normal clock, but it is actually loaded from the PNG,
that was generated by a custom command. You can display <strong>arbitrary graphics</strong>!</p>
<p>A program to generate an image:</p>
<pre><code class="language-python">import datetime
import cairo
import os
import time
import sys

while True:
    WIDTH, HEIGHT = 270, 28
    sfc = cairo.ImageSurface(cairo.Format.ARGB32, WIDTH, HEIGHT)
    ctx = cairo.Context(sfc)
    ctx.set_font_size(16) 
    ctx.select_font_face("Courier", cairo.FONT_SLANT_NORMAL, cairo.FONT_WEIGHT_NORMAL) 
    ctx.move_to(3, 20)
    ctx.set_source_rgb(1.0, 1.0, 1.0)
    time_str="%s" % datetime.datetime.now()
    ctx.show_text(time_str)
    ctx.fill()

    output_filename = '/tmp/custom-clock.png'
    sfc.write_to_png(output_filename)

    print(output_filename)
    print(time_str)
    sys.stdout.flush()
    time.sleep(1)

</code></pre>
<p>If run, it would write <code>/tmp/custom-clock.png</code> and print text like this</p>
<pre><code class="language-shell">$ python3 ./book/src/configuration/cookbook/custom-clock.py
/tmp/custom-clock.png
2024-06-30 21:09:22.165792
/tmp/custom-clock.png
2024-06-30 21:09:23.185004
/tmp/custom-clock.png
2024-06-30 21:09:24.195003
</code></pre>
<pre><code class="language-toml">[[command]]
name="img-clock"
command="python3 /home/user/Project/oatbar/clock.py"
line_names=["file_name", "ts"]

[[block]]
name = 'image'
type = 'image'
value = '${img-clock:file_name}'
updater_value = '${img-clock:ts}'
</code></pre>
<p>The value of <code>img-clock:ts</code> is not important, but because it
changes, the image is not cached. It get's reloaded from
the disk on each update.</p>
<div class="warning">
<p>This is not the most efficient way to build custom
widgets.</p>
<p>It involves writing/reading files from the
disk on each update. Building animations is possible, but
not efficient, which can matter for you if you are on
laptop battery. You can use <code>tmpfs</code> to save on disk writes,
but not so much on CPU cycles.</p>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="links"><a class="header" href="#links">Links</a></h1>
<ul>
<li><a href="https://crates.io/crates/oatbar">Crates.io</a></li>
<li><a href="https://github.com/igor-petruk/oatbar">Repository</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
